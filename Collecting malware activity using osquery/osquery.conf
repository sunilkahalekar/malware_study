{
  "schedule": {
    "malware_events": {
      "query": "SELECT timestamp, process_name, process_path, cmdline, cwd, parent, parent_path, uid, gid, euid, egid FROM process_events WHERE path LIKE '%/tmp/%' OR path LIKE '%/var/tmp/%' OR cmdline LIKE '%/tmp/%' OR cmdline LIKE '%/var/tmp/%'",
      "interval": 60,
      "description": "Detects malware activity in /tmp and /var/tmp directories"
    },
    "malware_user_login": {
      "query": "SELECT * FROM last WHERE time > DATE_SUB(NOW(), INTERVAL 1 DAY) AND username != 'root' AND username != ''",
      "interval": 60,
      "description": "Detects suspicious user logins in the past day"
    },
    "malware_network_activity": {
      "query": "SELECT * FROM process_open_sockets WHERE remote_address != '' AND remote_address NOT LIKE '127.%' AND remote_address NOT LIKE '192.168.%' AND remote_address NOT LIKE '10.%'",
      "interval": 60,
      "description": "Detects network connections to non-local addresses"
    },
    "malware_file_modification": {
      "query": "SELECT * FROM file_events WHERE action = 'modified' AND path NOT LIKE '%/Library/Preferences%' AND path NOT LIKE '%/Library/Caches%' AND path NOT LIKE '%/Library/Application Support%' AND path NOT LIKE '%/Users/Shared%'",
      "interval": 60,
      "description": "Detects suspicious file modifications outside of system directories"
    }
  }
}
