Collecting registry events of malware activity using osquery can help you detect and respond to malicious activity on your Windows systems. Here is a sample osquery configuration file that you could use as a starting point for monitoring registry events:

This configuration file schedules one query to run every 60 seconds:

malware_registry: This query detects any registry modifications in the HKEY_LOCAL_MACHINE, HKEY_USERS, and HKEY_CURRENT_USER hives, excluding modifications to the Image File Execution Options key path, which is commonly used by malware to bypass security measures. The query returns the timestamp of the modification, the type of event (created, deleted, or modified), the hive, key path, value name, and the new and old data.
Note that this is just a starting point, and you may need to customize the query to suit your specific needs and environment. Also, keep in mind that osquery should be used as part of a broader security strategy and not as a standalone solution.